@model IEnumerable<TiendaOnline.Models.Producto>

@{
    ViewBag.Title = "Home Page I";
}

<link rel="stylesheet" href="~/Content/Tienda/tienda-inicio.css" />
<link rel="stylesheet" href="~/Content/Index/carousel-multi-products.css" />

<style>
    .checked-star {
        color: #ff9f1a;
    }
</style>

@if (Session["TiendaId"] == null)
{
    <div style="background-color:#fff098">
        @Html.Action("_CrearTienda", "Home")
    </div>
}


<div id="myCarousel" class="carousel slide carousel-height" data-ride="carousel">
    <ol class="carousel-indicators">
        <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
        <li data-target="#myCarousel" data-slide-to="1"></li>
        <li data-target="#myCarousel" data-slide-to="2"></li>
    </ol>
    <div class="carousel-inner carousel-height">
        <div class="carousel-item active">
            <div class="row" style="background-color:#ffeb74">
                <div style="width:30%">
                    <div style="margin:20px">
                        <h2>Accede a ofertas exclusivas hoy.</h2>
                        <p>Los Mejores Productos y Servicios a Precios Imperdibles en diferentes Tiendas.</p>
                        <p><a class="btn btn-lg btn-primary" href="#" role="button">Ver más</a></p>
                    </div>
                </div>
                <div style="width:70%">
                    <img class="bd-placeholder-img" src="https://www.circulotoyota.cl/img/SlidersPagina/8/slider_accesoriosyrep.jpg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img"><rect width="100%" height="100%" fill="#777" />
                </div>
            </div>
        </div>
        <div class="carousel-item carousel-height">
            <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="https://www.reidrental.com/wp-content/uploads/2016/03/general-hire-earthworks-machinery-1350x600.jpg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img"><rect width="100%" height="100%" fill="#777" /></svg>
            <div class="container">
                <div class="carousel-caption">
                    <h1>Another example headline.</h1>
                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                    <p><a class="btn btn-lg btn-primary" href="#" role="button">Learn more</a></p>
                </div>
            </div>
        </div>
        <div class="carousel-item carousel-height">
            <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="https://www.abeoarchitects.com/wp-content/uploads/2016/09/CBGC-hero-1350x600.jpg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img"><rect width="100%" height="100%" fill="#777" /></svg>
            <div class="container">
                <div class="carousel-caption text-right">
                    <h1>One more for good measure.</h1>
                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                    <p><a class="btn btn-lg btn-primary" href="#" role="button">Browse gallery</a></p>
                </div>
            </div>
        </div>
    </div>
    <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
</div>
<div class="card-group" style="margin:15px; margin-top:-50px!important">
    <div class="card">
        <div class="row no-gutters">
            <div class="col-auto">
                <img src="https://i.imgur.com/8XkIdYl.jpg" width="100" class="img-fluid" alt="">
            </div>
            <div class="col">
                <div class="card-block px-3 pt-xl-3">
                    <h4 class="card-title">Productos</h4>
                    <p class="card-text">Description</p>
                </div>
            </div>
        </div>

        <a href="@Url.Action("Index","Home")" class="stretched-link"></a>
    </div>
    <div class="card">
        <div class="row no-gutters">
            <div class="col-auto">
                <img src="https://i.imgur.com/2Pmixay.png" width="100" class="img-fluid" alt="">
            </div>
            <div class="col">
                <div class="card-block px-3 pt-xl-3">
                    <h4 class="card-title">Servicios</h4>
                    <p class="card-text">Description</p>
                </div>
            </div>
        </div>
        <a href="@Url.Action("Index","Servicio")" class="stretched-link"></a>
    </div>
</div>

<div style="margin-left:15px; margin-right:15px">
    <div class="card" style="cursor: pointer; border-radius:0px; border-bottom: 0px">
        <div class="card-body align-items-end d-flex justify-content-end">
            <div style="width:100%; float:left">
                <h4> <span class="fa fa-star checked-star" style="margin-right:15px"></span>Tiendas más valoradas</h4>
            </div>
        </div>
    </div>
</div>
<div class="carousel-container">
    <div class="carousel-inner">
        <div class="track">
            @foreach (var tienda in ViewBag.Tiendas)
            {
                <div class="card-container" onclick="location.href='@Url.Action("Tienda", "Home", new { id = tienda.Id })';" style="cursor: pointer">
                    <div class="card card-carousel">
                        <div class="img">
                            @if (tienda.ImageProfile != null)
                            {
                                <img src="@Url.Content("~/ImagenesUsers/" + tienda.Id + "/Logos/" + System.IO.Path.GetFileName(tienda.ImageProfile.DireccionImagen))" style="object-fit: contain; height:200px">
                            }
                        </div>
                        <div class="info">
                            <h6 class="card-title text-center">
                                <span class="d-inline-block text-truncate" style="max-width: 200px; font-size:20px">
                                    @tienda.Nombre
                                </span>
                            </h6>
                            <div class="rating" style="width:100%; text-align:center">
                                <div class="stars" style="margin: 0 auto">
                                    <span class="fa fa-star checked-star"></span>
                                    <span class="fa fa-star checked-star"></span>
                                    <span class="fa fa-star checked-star"></span>
                                    <span class="fa fa-star checked-star"></span>
                                    <span class="fa fa-star checked-star"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
    <div class="nav">
        <button class="prev">
            <i class="material-icons">
                keyboard_arrow_left
            </i>
        </button>
        <button class="next">
            <i class="material-icons">
                keyboard_arrow_right
            </i>
        </button>
    </div>
</div>

<div style="margin-left:15px; margin-right:15px">
    <div class="card" style="cursor: pointer; border-radius:0px; border-bottom: 0px">
        <div class="card-body align-items-end d-flex justify-content-end">
            <div style="width:100%; float:left">
                <h4><i class="fas fa-tags" style="margin-right:15px"></i>Productos Destacados</h4>
            </div>
        </div>
    </div>
</div>

<div class="carousel-container-destacado">
    <div class="carousel-inner">
        <div class="track-destacado">
            @foreach (var item in Model)
            {
                <div class="card-container" onclick="location.href='@Url.Action("VerProducto", "Producto", new { id = item.Id })';" style="cursor: pointer">
                    <div class="card card-carousel" style="padding:10px">
                        <div class="img" style="margin-bottom:15px">
                            @if (item.Imagenes.Count > 0)
                            {
                                <img style="object-fit:contain; width:257px; height:200px" src="@Url.Content("~/ImagenesUsers/" + item.Tienda.Id + "/Productos/" + System.IO.Path.GetFileName(item.Imagenes.First().DireccionImagen))" alt="...">
                            }
                        </div>
                        <h4 class="card-title text-left">
                            <span class="d-inline-block text-truncate" style="max-width: 200px; font-size:20px">
                                @item.Nombre
                            </span>
                        </h4>
                        <div class="card-footer" style="background-color: #fff; border-top: 0px; padding-top: 0px; text-align: right">
                            <small class="text-muted" style="font-size:20px">$@Decimal.Parse(item.Precio.ToString(), System.Globalization.NumberStyles.Float)</small>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
    <div class="nav">
        <button class="prev-destacado">
            <i class="material-icons">
                keyboard_arrow_left
            </i>
        </button>
        <button class="next-destacado">
            <i class="material-icons">
                keyboard_arrow_right
            </i>
        </button>
    </div>
</div>


<div style="margin-left:15px; margin-right:15px">
    <div class="card" style="cursor: pointer; border-radius:0px; border-bottom: 0px">
        <div class="card-body align-items-end d-flex justify-content-end">
            <div style="width:100%; float:left">
                <h4> <i class="fas fa-dollar-sign" style="margin-right:15px"></i>Descuentos</h4>
            </div>
        </div>
    </div>
</div>
<div class="carousel-container-descuento">
    <div class="carousel-inner">
        <div class="track-descuento">
            @{
                var inverted = Model.Reverse();
            }
            @foreach (var item in inverted)
            {
                <div class="card-container" onclick="location.href='@Url.Action("VerProducto", "Producto", new { id = item.Id })';" style="cursor: pointer">
                    <div class="card card-carousel" style="padding:10px">
                        <div class="img" style="margin-bottom:15px">
                            @if (item.Imagenes.Count > 0)
                            {
                                <img style="object-fit:contain; width:257px; height:200px" src="@Url.Content("~/ImagenesUsers/" + item.Tienda.Id + "/Productos/" + System.IO.Path.GetFileName(item.Imagenes.First().DireccionImagen))" alt="...">
                            }
                        </div>
                        <h4 class="card-title text-left">
                            <span class="d-inline-block text-truncate" style="max-width: 200px; font-size:20px">
                                @item.Nombre
                            </span>
                        </h4>
                        <div class="card-footer" style="background-color: #fff; border-top: 0px; padding-top: 0px; text-align: right">
                            <small class="text-muted" style="font-size:20px">$@Decimal.Parse(item.Precio.ToString(), System.Globalization.NumberStyles.Float)</small>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
    <div class="nav">
        <button class="prev-descuento">
            <i class="material-icons">
                keyboard_arrow_left
            </i>
        </button>
        <button class="next-descuento">
            <i class="material-icons">
                keyboard_arrow_right
            </i>
        </button>
    </div>
</div>

<script>
    const prev = document.querySelector('.prev');
    const next = document.querySelector('.next');

    const track = document.querySelector('.track');

    let carouselWidth = document.querySelector('.carousel-container').offsetWidth;

    window.addEventListener('resize', () => {
        carouselWidth = document.querySelector('.carousel-container').offsetWidth;
    })

    let index = 0;

    next.addEventListener('click', () => {
        index++;
        prev.classList.add('show');
        track.style.transform = `translateX(-${(index * carouselWidth) - 100}px)`;

        if (track.offsetWidth - (index * carouselWidth) < carouselWidth) {
            next.classList.add('hide');
        }
    })

    prev.addEventListener('click', () => {
        index--;
        next.classList.remove('hide');
        if (index === 0) {
            prev.classList.remove('show');
        }
        track.style.transform = `translateX(-${index * carouselWidth}px)`;
    })

</script>

<script>
    const prev_destacado = document.querySelector('.prev-destacado');
    const next_destacado = document.querySelector('.next-destacado');

    const track_destacado = document.querySelector('.track-destacado');

    let carouselWidth_destacado = document.querySelector('.carousel-container-destacado').offsetWidth;

    window.addEventListener('resize', () => {
        carouselWidth_destacado = document.querySelector('.carousel-container-destacado').offsetWidth;
    })

    let index_destacado = 0;

    next_destacado.addEventListener('click', () => {
        index_destacado++;
        prev_destacado.classList.add('show');
        track_destacado.style.transform = `translateX(-${(index_destacado * carouselWidth_destacado) - 100}px)`;

        if (track_destacado.offsetWidth - (index_destacado * carouselWidth_destacado) < carouselWidth_destacado) {
            next_destacado.classList.add('hide');
        }
    })

    prev_destacado.addEventListener('click', () => {
        index_destacado--;
        next_destacado.classList.remove('hide');
        if (index_destacado === 0) {
            prev_destacado.classList.remove('show');
        }
        track_destacado.style.transform = `translateX(-${index_destacado * carouselWidth_destacado}px)`;
    })

</script>

<script>
    const prev_descuento = document.querySelector('.prev-descuento');
    const next_descuento = document.querySelector('.next-descuento');

    const track_descuento = document.querySelector('.track-descuento');

    let carouselWidth_descuento = document.querySelector('.carousel-container-descuento').offsetWidth;

    window.addEventListener('resize', () => {
        carouselWidth_descuento = document.querySelector('.carousel-container-descuento').offsetWidth;
    })

    let index_descuento = 0;

    next_descuento.addEventListener('click', () => {
        index_descuento++;
        prev_descuento.classList.add('show');
        track_descuento.style.transform = `translateX(-${(index_descuento * carouselWidth_descuento) - 100}px)`;

        if (track_descuento.offsetWidth - (index_descuento * carouselWidth_descuento) < carouselWidth_descuento) {
            next_descuento.classList.add('hide');
        }
    })

    prev_descuento.addEventListener('click', () => {
        index_descuento--;
        next_descuento.classList.remove('hide');
        if (index_descuento === 0) {
            prev_descuento.classList.remove('show');
        }
        track_descuento.style.transform = `translateX(-${index_descuento * carouselWidth_descuento}px)`;
    })

</script>

<style>
    .col-sm-3 {
        padding-right: 0px !important;
        padding-left: 0px !important;
    }

    .card-product:hover {
        background-color: #efefef;
        opacity: 0.6;
        -webkit-transition-duration: 0.5s;
        -moz-transition-duration: 0.5s;
        -o-transition-duration: 0.5s;
        transition-duration: 0.5s;
    }

    .card {
        border-radius: 0px;
    }

    .row {
        margin-right: 0px !important;
        margin-left: 0px !important
    }

    .card-body {
        padding: 1rem;
    }
</style>

<style>
    .carousel-height {
        height: 300px;
    }
</style>
